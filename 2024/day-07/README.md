### Note
Part 2 is slow. Refactor it later.
